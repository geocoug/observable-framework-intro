name: Deploy

on:
  workflow_dispatch: {}
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      deployments: write
      packages: read
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          # cache: 'yarn'
          # cache-dependency-path: |
          #   yarn.lock
          #   'examples/*/yarn.lock'
      # - run: yarn --frozen-lockfile
      # - id: date
      #   run: echo "date=$(TZ=America/Los_Angeles date +'%Y-%m-%d')" >> $GITHUB_OUTPUT
      # - id: cache-data
      #   uses: actions/cache@v4
      #   with:
      #     path: |
      #       docs/.observablehq/cache
      #     key: data-${{ hashFiles('docs/data/*') }}-${{ steps.date.outputs.date }}
      # - if: steps.cache-data.outputs.cache-hit == 'true'
        # run: find docs/.observablehq/cache -type f -exec touch {} +
      # - run: yarn build
      # - name: Build site
      #   run: yarn --frozen-lockfile && yarn build
      #   working-directory: .
      #   env:
      #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Build site
        run: |
          npm ci
          npm run build
      - name: Deploy ðŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: dist